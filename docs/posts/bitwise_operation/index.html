<!DOCTYPE html>
<html lang='en-us'>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>bitwise operation</title>
    
    
    <style type="text/css" media="all">@import "/css/style.css";</style>
    <style type="text/css" media="all">@import "/css/syntax.css";</style>
    
  </head>
  <body>
    <header>
  <span class="site-title"
    style="font-size:3rem;display:inline-block;vertical-align:middle;"><a
      href="https://upunder.us"><img src="/icon/favicon.svg" alt="img" width="64rem"
        height="64rem"
        style="display:inline-block;vertical-align: middle;" /></a> up under us</span>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  
</header>

    


<main>
  <article>
    <header>
      <h1>bitwise operation</h1>
    </header>
    <time datetime='2023-11-15T00:00:00'>
      2023.11.15 00:00
    </time>
    
    Reading time:
    
    
    
    
    1 min
    
    12 s.
    <div>
      <h3>Table of contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#lowbit">lowbit</a></li>
  </ul>
</nav>
    </div>
    <h1 id="lowbit">lowbit</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>x <span style="color:#f92672">&amp;</span> <span style="color:#f92672">-</span>x;<span style="color:#75715e">//extract the rightmost set bit (the least significant bit that is set to 1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>x <span style="color:#f92672">-</span> (x <span style="color:#f92672">&amp;</span> (x <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>));<span style="color:#75715e">//extract the rightmost set bit (the least significant bit that is set to 1)
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> x <span style="color:#f92672">&amp;</span> (x <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);<span style="color:#75715e">//clears the lowest (least significant) 1 bit
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>x <span style="color:#f92672">=</span> x <span style="color:#f92672">-</span> (x <span style="color:#f92672">&amp;</span> <span style="color:#f92672">-</span>x);<span style="color:#75715e">//clears the lowest (least significant) 1 bit
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>((<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">&amp;</span> x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>;<span style="color:#75715e">//check if the bit at position i is equals 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>x <span style="color:#f92672">=</span> x <span style="color:#f92672">|</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>));<span style="color:#75715e">//set the bit at position to 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>x <span style="color:#f92672">=</span> x <span style="color:#f92672">&amp;</span> (<span style="color:#f92672">~</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)));<span style="color:#75715e">//set the bit at position to 0
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>x<span style="color:#f92672">=-~</span>x;<span style="color:#75715e">//x++;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>x<span style="color:#f92672">=~-</span>x;<span style="color:#75715e">//x--;
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>(x <span style="color:#f92672">&amp;</span> (x<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> x <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>;<span style="color:#75715e">//true when x is a power of 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>(x <span style="color:#f92672">&amp;</span> <span style="color:#f92672">-</span>x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> x <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>;<span style="color:#75715e">//true when x is a power of 2
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>(<span style="color:#66d9ef">int</span>)(<span style="color:#f92672">!!</span>x <span style="color:#f92672">-</span> (((<span style="color:#66d9ef">unsigned</span>)x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span>) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>));<span style="color:#75715e">//sgn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>(<span style="color:#66d9ef">int</span>)((x<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">31</span>) <span style="color:#f92672">|</span> ((<span style="color:#66d9ef">unsigned</span>)<span style="color:#f92672">-</span>x<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">31</span>));<span style="color:#75715e">//sgn
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>(((x <span style="color:#f92672">^</span> y) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;&amp;</span> (x <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;&amp;</span> (y <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>)) <span style="color:#f92672">||</span> ((x<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;&amp;</span> (y<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>))<span style="color:#75715e">//has same sign
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>(x <span style="color:#f92672">^</span> (x<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">31</span>)) <span style="color:#f92672">-</span> (x<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">31</span>);<span style="color:#75715e">//abs;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>(x<span style="color:#f92672">&amp;</span>y)<span style="color:#f92672">+</span>((x<span style="color:#f92672">^</span>y)<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">1</span>);<span style="color:#75715e">//ave;
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>x<span style="color:#f92672">^=</span>y;
</span></span><span style="display:flex;"><span>y<span style="color:#f92672">^=</span>x;
</span></span><span style="display:flex;"><span>x<span style="color:#f92672">^=</span>y;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//swap
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">calc</span>(<span style="color:#66d9ef">int</span> n){
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">|=</span> n<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">|=</span> n<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">|=</span> n<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">|=</span> n<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">8</span>;
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">|=</span> n<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">16</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">//next power of two that is greater than or equal to the given integer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">unsigned</span> <span style="color:#a6e22e">log2</span>(<span style="color:#66d9ef">unsigned</span> n){ 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">double</span> d <span style="color:#f92672">=</span> (<span style="color:#66d9ef">double</span>)n;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> r <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span><span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>d); 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (r <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">52</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x3FF</span>; 
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span>(b <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> carry <span style="color:#f92672">=</span> (a <span style="color:#f92672">&amp;</span> b) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">^=</span> b;
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> carry;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> a;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
    
  </article>
</main>

<a href="https://upunder.us/posts/random_algorithms/">Prev: random algorithms</a>

<br>

<a href="https://upunder.us/posts/prime_algorithms/">Next: prime algorithms</a>

<aside class="latest-posts">
  <div>
    <div class="section-header">
      <h3>LATEST POSTS</h3>
    </div>
    <div class="post-list">
      <ul>
        
        <li><a href="/posts/english_grammar/">english grammar</a></li>
        
        <li><a href="/posts/number_theory/">number theory</a></li>
        
        <li><a href="/posts/mnemonic/">mnemonic</a></li>
        
        <li><a href="/posts/cstring/">cstring</a></li>
        
        <li><a href="/posts/arithmetic_overflow/">arithmetic overflow</a></li>
        
      </ul>
    </div>
  </div>
</aside>


    <footer class="site-footer">
  <p>2024 <a href="https://upunder.us">up under us</a></p>
</footer>

  </body>
</html>
