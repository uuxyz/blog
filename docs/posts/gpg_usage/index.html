<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>gpg usage</title>
    
    
    <style type="text/css" media="all">@import "/style.css";</style>
    <style type="text/css" media="all">@import "/syntax.css";</style>
    
  </head>
  <body>
    <header>
  <span class="site-title" style="font-size:3rem;display:inline-block;vertical-align:middle;"><a href="https://upunder.us"><img src="/favicon.svg" alt="img" width="64rem" height="64rem" style="display:inline-block;vertical-align: middle;"/></a> up under us</span>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  
</header>

    


<main>
  <article>
    <header>
      <h1>gpg usage</h1>
    </header>
    <time datetime="2022-05-07T00:00:00">
      2022.05.07 00:00
    </time>
    
    Reading time:
    
    
    
    
    1 min
    
    26 s.
    <div>
      <h3>Table of contents</h3>
      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#generate">generate</a></li>
<li><a href="#import">import</a></li>
<li><a href="#encrypt-and-decrypt">encrypt and decrypt</a></li>
<li><a href="#signature">signature</a></li>
<li><a href="#ssh">ssh</a></li>
</ul></li>
</ul>
</nav>
    </div>
    

<h2 id="generate">generate</h2>

<p>First we need to generate a key.</p>

<pre><code class="language-bash">gpg --full-generate-key
</code></pre>

<h2 id="import">import</h2>

<p>If you already have a private key, then you can import it and change its trust level to ultimate.</p>

<pre><code class="language-bash">gpg --import u_prv.gpg
gpg --edit-key u_u_u
trust
  1 = I don't know or won't say
  2 = I do NOT trust
  3 = I trust marginally
  4 = I trust fully
  5 = I trust ultimately
  m = back to the main menu
5
save
</code></pre>

<h2 id="encrypt-and-decrypt">encrypt and decrypt</h2>

<p>We can encrypt the file with our public key.</p>

<pre><code class="language-bash">gpg -r u_u_u -ae hello_world.txt -o hello_world.gpg
</code></pre>

<p>Then decrypt it with the private key.</p>

<pre><code class="language-bash">gpg -d hello_world.gpg -o out.txt
</code></pre>

<h2 id="signature">signature</h2>

<p>We can use our private key to sign a file, the first method generates a standalone signature file, the second method deposits the contents of the file along with the signature, and the third method, which applies to text, generates an <code>.asc</code> text containing the original message and additional signatures.</p>

<pre><code class="language-bash">gpg -b hello_world.txt
gpg -s hello_world.txt
gpg --clearsign hello_world.txt
</code></pre>

<p>Accordingly, we can verify these signatures. The first three ways correspond to the three signature methods mentioned above. If you only need to verify and not output the encrypted information, then you can use the <code>--verify</code> option</p>

<pre><code class="language-bash">gpg -d hello_world.txt hello_world.txt.sig
gpg -d hello_world.txt.gpg
gpg -d hello_world.txt.asc
gpg --verify hello_world.txt.gpg
</code></pre>

<p>Export and keep your keys safe</p>

<pre><code class="language-bash">gpg --export -a u_u_u -o u_pub.gpg 
gpg --export -a u_u_u -o u_prv.gpg 
</code></pre>

<h2 id="ssh">ssh</h2>

<p>You can use gpg to manage ssh logins.
Enable gpg-agent first.</p>

<pre><code class="language-bash">echo &quot;enable-ssh-support&quot; &gt;&gt; ~/.gnupg/gpg-agent.conf
</code></pre>

<p>Find the subkey you need. Then add it to the <code>sshcontrol</code> file</p>

<pre><code class="language-bash">gpg --list-keys --with-keygrip
echo &quot;4B819AB5710A8EC4DF1B9E2169B9147975778499&quot; ~/.gnupg/sshcontrol
</code></pre>

<p>Start gpg-agent.</p>

<pre><code class="language-bash">gpgconf --launch gpg-agent
export SSH_AUTH_SOCK=$(gpgconf --list-dirs agent-ssh-socket)
</code></pre>

<p>Then you can export your ssh public key.</p>

<pre><code class="language-bash">ssh-add -L
ssh-add -l
</code></pre>

<p>Connect to github and test it.</p>

<pre><code class="language-bash">ssh -T git@github.com:uuxyz/history.git
</code></pre>

<p>If it goes well, you&rsquo;ll see this:
&gt; Hi uuxyz! You&rsquo;ve successfully authenticated, but GitHub does not provide shell access.</p>

    
  </article>
</main>

<a href="https://upunder.us/posts/git_usage/">Prev: git usage</a>

<br>

<a href="https://upunder.us/posts/computer_restart/">Next: computer restart</a>

<aside class="latest-posts">
  <div>
    <div class="section-header">
      <h3>LATEST POSTS</h3>
    </div>
    <div class="post-list">
      <ul>
        
        <li><a href="/posts/bijection/">bijection</a></li>
        
        <li><a href="/posts/curves/">curves</a></li>
        
        <li><a href="/posts/calculus/">calculus</a></li>
        
        <li><a href="/posts/prime_algorithms/">prime algorithms</a></li>
        
        <li><a href="/posts/bitwise_operation/">bitwise operation</a></li>
        
      </ul>
    </div>
  </div>
</aside>


    <footer class="site-footer">
  <p>2023 <a href="https://upunder.us">up under us</a></p>
</footer>

  </body>
</html>
